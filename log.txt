# Reference: https://github.com/DLR-RM/rl-baselines3-zoo/blob/master/hyperparams/ppo.yml#L32
seed: 42

n_timesteps: !!float 1e6
policy: 'MlpPolicy'
n_steps: 16
batch_size: 4096
gae_lambda: 0.95
gamma: 0.99
n_epochs: 20
ent_coef: 0.01
learning_rate: !!float 3e-4
clip_range: !!float 0.2
policy_kwargs: "dict(
                  activation_fn=nn.ELU,
                  net_arch=[32, 32],
                  squash_output=False,
                )"
vf_coef: 1.0
max_grad_norm: 1.0
device: "cuda:0"



# Tuned
Pendulum-v1:
  n_envs: 4
  n_timesteps: !!float 1e5
  policy: 'MlpPolicy'
  n_steps: 1024
  gae_lambda: 0.95
  gamma: 0.9
  n_epochs: 10
  ent_coef: 0.0
  learning_rate: !!float 1e-3
  clip_range: 0.2
  use_sde: True
  sde_sample_freq: 4

# Tuned
CartPole-v1:
  n_envs: 8
  n_timesteps: !!float 1e5
  policy: 'MlpPolicy'
  n_steps: 32
  batch_size: 256
  gae_lambda: 0.8
  gamma: 0.98
  n_epochs: 20
  ent_coef: 0.0
  learning_rate: lin_0.001
  clip_range: lin_0.2


ActionsCfg scale 50 => 
joint_efforts: tensor([[-2606.2766]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>
[Env 0]: Pole joint:  -100.0
joint_efforts: tensor([[3451.4514]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>
[Env 0]: Pole joint:  100.0001449584961
joint_efforts: tensor([[-2606.6353]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>
[Env 0]: Pole joint:  -100.0

ActionsCfg scale 5 => 
joint_efforts: tensor([[-3005.1240]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>
[Env 0]: Pole joint:  -100.00004577636719
joint_efforts: tensor([[3005.1707]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>
[Env 0]: Pole joint:  100.00000762939453
joint_efforts: tensor([[-3005.1245]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>
[Env 0]: Pole joint:  -99.99996948242188
joint_efforts: tensor([[3005.1660]], device='cuda:0') torch.Size([1, 1]) <class 'torch.Tensor'>

ActionsCfg scale 1 => 
Good